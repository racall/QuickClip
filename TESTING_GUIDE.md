# QuickClip 测试指南

## 🔍 快捷键功能测试步骤

### 1. 首次运行准备

1. 在 Xcode 中运行项目（⌘R）
2. 应用启动后，**查看 Xcode 控制台输出**，你应该看到：
   ```
   ✅ 辅助功能权限已授予
   ```
   或
   ```
   ⚠️ 需要辅助功能权限才能使用全局快捷键
   请前往：系统设置 > 隐私与安全性 > 辅助功能，添加 QuickClip
   ```

3. **如果看到警告，必须手动授予权限**（这是正常的！）：

   **步骤：**
   - 打开 **系统设置**（Apple 菜单 > 系统设置）
   - 在左侧点击 **隐私与安全性**
   - 在右侧找到并点击 **辅助功能**
   - 点击左下角 **🔒 锁图标** 解锁（需要输入密码）
   - 在应用列表中找到 **Xcode**（因为是从 Xcode 运行的）
   - 勾选 Xcode 旁边的复选框 ✅
   - 点击锁图标重新锁定
   - **回到 Xcode，停止应用（⌘.）然后重新运行（⌘R）**

4. 重新运行后，控制台应该显示：
   ```
   ✅ 辅助功能权限已授予
   ```

**重要提示：**
- macOS 不会自动弹出权限对话框，你必须手动设置
- 如果是从 Xcode 运行，需要授权给 **Xcode**
- 如果是导出的 .app 文件运行，需要授权给 **QuickClip**
- 授权后必须重启应用才能生效

### 2. 创建测试片段

1. 在 QuickClip 主界面，点击左下角 **"新建片段"** 按钮
2. 输入测试数据：
   - 标题：`测试片段`
   - 内容：`这是一个测试内容，用于验证快捷键功能。`

### 3. 设置快捷键

1. 点击 **"录制快捷键"** 按钮
2. 按下你想要的快捷键组合，例如：
   - `⌘⇧T`（Command + Shift + T）
   - `⌃⌥C`（Control + Option + C）
   - `⌘⌥1`（Command + Option + 1）

3. **查看 Xcode 控制台**，你应该看到类似输出：
   ```
   🎯 录制到快捷键: ⌘⇧T
   💾 数据已保存
   📣 发送快捷键变化通知
   📢 收到片段变化通知
   🔄 开始注册所有快捷键...
   📋 找到 1 个片段
   🔑 尝试注册快捷键: ⌘⇧T for '测试片段'
     解析结果 - keyCode: 17, modifiers: 768
     ✅ 快捷键注册成功
   ✅ 成功注册 1 个快捷键
   ```

### 4. 测试全局快捷键

1. **切换到其他应用**（如浏览器、文本编辑器等）
2. 按下你设置的快捷键（如 `⌘⇧T`）
3. **查看 Xcode 控制台**，应该看到：
   ```
   ⌨️ 快捷键被触发! ID: xxxxx
   📝 找到片段ID: xxxxx
   ✅ 复制片段到剪贴板: 测试片段
   ```

4. **粘贴测试**：在任意文本编辑器中按 `⌘V`，应该粘贴出：
   ```
   这是一个测试内容，用于验证快捷键功能。
   ```

5. **观察状态栏**：QuickClip 的状态栏图标应该从剪贴板图标变成对勾图标，1.5秒后恢复

### 5. 状态栏菜单测试

1. 点击状态栏的 QuickClip 图标
2. 应该看到：
   - 前10个片段列表（显示标题和快捷键）
   - "打开 QuickClip" 菜单项
   - "退出" 菜单项

3. 点击任意片段，内容应该自动复制到剪贴板

## 🐛 问题排查

### 问题1：快捷键不生效

**检查点：**
1. 查看控制台是否有 "✅ 辅助功能权限已授予"
2. 查看控制台是否有 "✅ 快捷键注册成功"
3. 确认快捷键没有与系统或其他应用冲突

**解决方法：**
- 检查 **系统设置 > 辅助功能** 中是否已授权
- 尝试使用不同的快捷键组合
- 重启应用

### 问题2：权限弹窗没有出现

这是正常的！macOS 不会自动弹出权限对话框，你需要：
1. 查看控制台输出，确认是否需要授权
2. 手动前往 **系统设置 > 隐私与安全性 > 辅助功能**
3. 手动添加应用

### 问题3：控制台看不到日志

确保：
1. Xcode 底部的控制台面板已打开（⌘⇧Y）
2. 在控制台右上角搜索框中搜索 "快捷键" 或 "🔑"

### 问题4：快捷键冲突

如果快捷键注册失败（status != 0），说明：
- 该快捷键已被系统或其他应用占用
- 尝试使用不同的组合键

## 📝 控制台日志说明

| 日志符号 | 含义 |
|---------|------|
| ✅ | 成功 |
| ❌ | 失败 |
| ⚠️ | 警告 |
| 🔄 | 正在处理 |
| 🔑 | 快捷键相关 |
| 📋 | 片段相关 |
| ⌨️ | 快捷键触发 |
| 💾 | 数据保存 |
| 📣 | 发送通知 |

## ✅ 成功标志

如果一切正常，你应该能：
1. ✅ 看到辅助功能权限授予的日志
2. ✅ 成功录制快捷键
3. ✅ 看到快捷键注册成功的日志
4. ✅ 在任何应用中按快捷键都能复制片段
5. ✅ 状态栏图标会显示反馈动画
6. ✅ 粘贴时得到正确的内容
